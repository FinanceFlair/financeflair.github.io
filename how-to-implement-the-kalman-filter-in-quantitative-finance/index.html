<!doctype html><html lang=en dir=auto><head><title>How to Implement the Kalman Filter in Quantitative Finance</title>
<link rel=canonical href=https://finance.googlexy.com/how-to-implement-the-kalman-filter-in-quantitative-finance/><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><meta name=description content><meta name=author content><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://finance.googlexy.com/logo.svg><link rel=icon type=image/png sizes=16x16 href=https://finance.googlexy.com/logo.svg><link rel=icon type=image/png sizes=32x32 href=https://finance.googlexy.com/logo.svg><link rel=apple-touch-icon href=https://finance.googlexy.com/logo.svg><link rel=mask-icon href=https://finance.googlexy.com/logo.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://finance.googlexy.com/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="All the money talk you need!"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://finance.googlexy.com/"><meta name=twitter:card content="summary"><meta name=twitter:title content="All the money talk you need!"><meta name=twitter:description content><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","name":"All the money talk you need!","url":"https://finance.googlexy.com/","description":"","thumbnailUrl":"https://finance.googlexy.com/logo.svg","sameAs":[]}</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6194699946397512" crossorigin=anonymous></script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://finance.googlexy.com/ accesskey=h title="Home (Alt + H)"><img src=https://finance.googlexy.com/logo.svg alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://finance.googlexy.com/articles/ title=Articles><span>Articles</span></a></li><li><a href=https://finance.googlexy.com/categories/ title=Categories><span>Categories</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">How to Implement the Kalman Filter in Quantitative Finance</h1><div class=post-description></div></header><figure class=entry-cover><img loading=eager src=https://finance.googlexy.com/images/quantitative-finance-models.jpeg alt></figure><br><div class=post-content><p>The Kalman Filter is an efficient and powerful algorithm used to estimate the state of a dynamic system from noisy and uncertain measurements. Although originally designed for aerospace engineering and navigation systems, its applications have since expanded across numerous fields, including quantitative finance. In finance, the Kalman Filter is primarily used for estimating financial models, forecasting time series, and smoothing noisy data, among other tasks. This article will guide you through the implementation of the Kalman Filter in quantitative finance, exploring its underlying concepts, financial applications, and providing a practical approach to coding it.</p><h2 id=what-is-the-kalman-filter>What is the Kalman Filter?</h2><p>The Kalman Filter is a recursive algorithm that works in two phases: prediction and update. In the prediction phase, the algorithm uses the current state estimate to predict the next state, while the update phase adjusts this prediction using the actual measurements (data). The filter’s strength lies in its ability to incorporate new data into the estimate, progressively improving the state prediction while reducing the uncertainty of the estimates.</p><p>The basic form of the Kalman Filter is designed for linear systems. However, in many practical scenarios, the Kalman Filter has been extended to handle non-linear models, leading to the development of variations such as the Extended Kalman Filter (EKF) and the Unscented Kalman Filter (UKF).</p><h2 id=kalman-filter-mathematical-framework>Kalman Filter Mathematical Framework</h2><p>The Kalman Filter operates based on a state-space model that is composed of two equations:</p><ol><li><p><strong>State Equation</strong> (Predicts the next state):
[
x_k = A \cdot x_{k-1} + B \cdot u_k + w_k
]
Here, ( x_k ) is the state at time ( k ), ( A ) is the state transition matrix, ( B ) is the control matrix, ( u_k ) is the control input, and ( w_k ) is the process noise.</p></li><li><p><strong>Measurement Equation</strong> (Relates the measurement to the state):
[
z_k = H \cdot x_k + v_k
]
In this equation, ( z_k ) is the observed measurement at time ( k ), ( H ) is the measurement matrix, and ( v_k ) is the measurement noise.</p></li></ol><p>The goal of the Kalman Filter is to estimate the state ( x_k ) based on noisy observations ( z_k ), while minimizing the uncertainty in the estimate. The two primary steps in the filter are the <strong>prediction</strong> of the state and the <strong>update</strong> using the measurements.</p><h3 id=the-two-phases-of-kalman-filter>The Two Phases of Kalman Filter</h3><h4 id=1-prediction-phase>1. <strong>Prediction Phase</strong></h4><p>In the prediction step, the Kalman Filter uses the previous state estimate to predict the current state and its uncertainty:</p><ul><li><strong>Predicted State Estimate</strong>:
[
\hat{x}^-<em>k = A \cdot \hat{x}</em>{k-1} + B \cdot u_k
]</li><li><strong>Predicted Estimate Covariance</strong>:
[
P^-<em>k = A \cdot P</em>{k-1} \cdot A^T + Q
]
Here, ( \hat{x}^-_k ) is the predicted state, ( P^-_k ) is the predicted covariance, and ( Q ) is the process noise covariance.</li></ul><h4 id=2-update-phase>2. <strong>Update Phase</strong></h4><p>In the update step, the Kalman Filter adjusts the predicted state estimate using the actual measurement and the associated uncertainty:</p><ul><li><strong>Kalman Gain</strong>:
[
K_k = P^-_k \cdot H^T \cdot (H \cdot P^-_k \cdot H^T + R)^{-1}
]</li><li><strong>Updated State Estimate</strong>:
[
\hat{x}_k = \hat{x}^-_k + K_k \cdot (z_k - H \cdot \hat{x}^-_k)
]</li><li><strong>Updated Estimate Covariance</strong>:
[
P_k = (I - K_k \cdot H) \cdot P^-_k
]
Where ( K_k ) is the Kalman Gain, ( R ) is the measurement noise covariance, and ( I ) is the identity matrix.</li></ul><p>The Kalman Gain ( K_k ) plays a crucial role in determining how much weight should be given to the prediction versus the new measurement. A high Kalman Gain means more reliance on the measurement, while a low value indicates greater trust in the prediction.</p><h2 id=kalman-filter-in-quantitative-finance>Kalman Filter in Quantitative Finance</h2><p>In quantitative finance, the Kalman Filter can be applied to a variety of problems. Some of the most common uses include:</p><h3 id=1-estimating-stock-price-movements>1. <strong>Estimating Stock Price Movements</strong></h3><p>In stock price modeling, the Kalman Filter is often used to estimate the underlying state of a stock’s price process. This is particularly useful in filtering out noise from historical prices and determining the true underlying trend. For example, you could model a stock price using a stochastic differential equation and use the Kalman Filter to track the price over time, adjusting the estimate as new price data becomes available.</p><h3 id=2-portfolio-optimization>2. <strong>Portfolio Optimization</strong></h3><p>In portfolio optimization, the Kalman Filter is used to estimate the expected returns and covariances of different assets. By applying the filter, an investor can dynamically update their portfolio allocation based on the latest data, accounting for changes in market conditions. This allows for better adaptive strategies, where the portfolio is constantly updated as new information is incorporated.</p><h3 id=3-risk-management>3. <strong>Risk Management</strong></h3><p>Kalman Filters can also be employed in risk management to estimate the volatility of asset returns over time. By smoothing out the noise in volatility estimates, financial institutions can obtain a more accurate understanding of their risk exposure. This is particularly important for managing assets with volatile or highly uncertain price movements.</p><h3 id=4-interest-rate-modeling>4. <strong>Interest Rate Modeling</strong></h3><p>In the modeling of interest rates, the Kalman Filter can help estimate the parameters of a term structure model, such as the Vasicek or CIR model. This allows for the dynamic estimation of interest rates, which is essential for pricing and hedging fixed income products like bonds and derivatives.</p><h3 id=5-hidden-markov-models-hmms>5. <strong>Hidden Markov Models (HMMs)</strong></h3><p>Kalman Filters can be combined with Hidden Markov Models (HMMs) to model regimes or states in financial markets. For example, market conditions could be classified into different regimes (e.g., bull or bear markets), and the Kalman Filter can be used to estimate the transition between these regimes over time, enabling traders to adapt their strategies accordingly.</p><h2 id=implementing-the-kalman-filter-in-python-for-quantitative-finance>Implementing the Kalman Filter in Python for Quantitative Finance</h2><p>To demonstrate the practical application of the Kalman Filter, let’s walk through an implementation in Python. We&rsquo;ll use historical stock price data to estimate the underlying trend, smoothing out the noise in the data.</p><h3 id=step-1-install-required-libraries>Step 1: Install Required Libraries</h3><p>First, make sure you have the necessary libraries installed:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-bash data-lang=bash><span class=line><span class=cl>pip install numpy pandas matplotlib yfinance
</span></span></code></pre></div><h3 id=step-2-download-historical-stock-data>Step 2: Download Historical Stock Data</h3><p>Let’s download the historical stock price data of a company (e.g., Apple) using the <code>yfinance</code> library:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>yfinance</span> <span class=k>as</span> <span class=nn>yf</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Download historical stock price data</span>
</span></span><span class=line><span class=cl><span class=n>ticker</span> <span class=o>=</span> <span class=s2>&#34;AAPL&#34;</span>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=n>yf</span><span class=o>.</span><span class=n>download</span><span class=p>(</span><span class=n>ticker</span><span class=p>,</span> <span class=n>start</span><span class=o>=</span><span class=s2>&#34;2010-01-01&#34;</span><span class=p>,</span> <span class=n>end</span><span class=o>=</span><span class=s2>&#34;2025-01-01&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>data</span> <span class=o>=</span> <span class=n>data</span><span class=p>[</span><span class=s1>&#39;Adj Close&#39;</span><span class=p>]</span>  <span class=c1># Use adjusted close prices for analysis</span>
</span></span></code></pre></div><h3 id=step-3-initialize-kalman-filter-parameters>Step 3: Initialize Kalman Filter Parameters</h3><p>Next, we initialize the parameters for the Kalman Filter. For simplicity, we will model the stock price as a random walk.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>numpy</span> <span class=k>as</span> <span class=nn>np</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Initialize Kalman Filter parameters</span>
</span></span><span class=line><span class=cl><span class=n>A</span> <span class=o>=</span> <span class=mi>1</span>  <span class=c1># State transition matrix (random walk)</span>
</span></span><span class=line><span class=cl><span class=n>H</span> <span class=o>=</span> <span class=mi>1</span>  <span class=c1># Measurement matrix</span>
</span></span><span class=line><span class=cl><span class=n>Q</span> <span class=o>=</span> <span class=mf>0.1</span>  <span class=c1># Process noise covariance (assumed)</span>
</span></span><span class=line><span class=cl><span class=n>R</span> <span class=o>=</span> <span class=mi>1</span>  <span class=c1># Measurement noise covariance</span>
</span></span><span class=line><span class=cl><span class=n>P</span> <span class=o>=</span> <span class=mi>1</span>  <span class=c1># Initial estimate covariance</span>
</span></span><span class=line><span class=cl><span class=n>x</span> <span class=o>=</span> <span class=n>data</span><span class=o>.</span><span class=n>iloc</span><span class=p>[</span><span class=mi>0</span><span class=p>]</span>  <span class=c1># Initial state estimate (first observed price)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Arrays to store results</span>
</span></span><span class=line><span class=cl><span class=n>predicted_prices</span> <span class=o>=</span> <span class=p>[]</span>
</span></span><span class=line><span class=cl><span class=n>estimated_prices</span> <span class=o>=</span> <span class=p>[]</span>
</span></span></code></pre></div><h3 id=step-4-apply-the-kalman-filter>Step 4: Apply the Kalman Filter</h3><p>Now, we apply the Kalman Filter to the stock data:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=k>for</span> <span class=n>z</span> <span class=ow>in</span> <span class=n>data</span><span class=p>:</span>
</span></span><span class=line><span class=cl>    <span class=c1># Prediction phase</span>
</span></span><span class=line><span class=cl>    <span class=n>x_pred</span> <span class=o>=</span> <span class=n>A</span> <span class=o>*</span> <span class=n>x</span>
</span></span><span class=line><span class=cl>    <span class=n>P_pred</span> <span class=o>=</span> <span class=n>A</span> <span class=o>*</span> <span class=n>P</span> <span class=o>*</span> <span class=n>A</span> <span class=o>+</span> <span class=n>Q</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Update phase</span>
</span></span><span class=line><span class=cl>    <span class=n>K</span> <span class=o>=</span> <span class=n>P_pred</span> <span class=o>*</span> <span class=n>H</span> <span class=o>/</span> <span class=p>(</span><span class=n>H</span> <span class=o>*</span> <span class=n>P_pred</span> <span class=o>*</span> <span class=n>H</span> <span class=o>+</span> <span class=n>R</span><span class=p>)</span>  <span class=c1># Kalman Gain</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>=</span> <span class=n>x_pred</span> <span class=o>+</span> <span class=n>K</span> <span class=o>*</span> <span class=p>(</span><span class=n>z</span> <span class=o>-</span> <span class=n>H</span> <span class=o>*</span> <span class=n>x_pred</span><span class=p>)</span>  <span class=c1># Updated state estimate</span>
</span></span><span class=line><span class=cl>    <span class=n>P</span> <span class=o>=</span> <span class=p>(</span><span class=mi>1</span> <span class=o>-</span> <span class=n>K</span> <span class=o>*</span> <span class=n>H</span><span class=p>)</span> <span class=o>*</span> <span class=n>P_pred</span>  <span class=c1># Updated estimate covariance</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c1># Store results</span>
</span></span><span class=line><span class=cl>    <span class=n>predicted_prices</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>x_pred</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>estimated_prices</span><span class=o>.</span><span class=n>append</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Convert lists to arrays</span>
</span></span><span class=line><span class=cl><span class=n>predicted_prices</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>predicted_prices</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>estimated_prices</span> <span class=o>=</span> <span class=n>np</span><span class=o>.</span><span class=n>array</span><span class=p>(</span><span class=n>estimated_prices</span><span class=p>)</span>
</span></span></code></pre></div><h3 id=step-5-plot-the-results>Step 5: Plot the Results</h3><p>Finally, we can plot the actual stock prices, predicted prices, and the Kalman-filtered estimates:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-python data-lang=python><span class=line><span class=cl><span class=kn>import</span> <span class=nn>matplotlib.pyplot</span> <span class=k>as</span> <span class=nn>plt</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>figure</span><span class=p>(</span><span class=n>figsize</span><span class=o>=</span><span class=p>(</span><span class=mi>10</span><span class=p>,</span> <span class=mi>6</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>index</span><span class=p>,</span> <span class=n>data</span><span class=o>.</span><span class=n>values</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s2>&#34;Actual Prices&#34;</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s2>&#34;blue&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>index</span><span class=p>,</span> <span class=n>predicted_prices</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s2>&#34;Predicted Prices&#34;</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s2>&#34;orange&#34;</span><span class=p>,</span> <span class=n>linestyle</span><span class=o>=</span><span class=s2>&#34;--&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>plot</span><span class=p>(</span><span class=n>data</span><span class=o>.</span><span class=n>index</span><span class=p>,</span> <span class=n>estimated_prices</span><span class=p>,</span> <span class=n>label</span><span class=o>=</span><span class=s2>&#34;Kalman Filter Estimate&#34;</span><span class=p>,</span> <span class=n>color</span><span class=o>=</span><span class=s2>&#34;green&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>title</span><span class=p>(</span><span class=sa>f</span><span class=s2>&#34;Kalman Filter Estimation for </span><span class=si>{</span><span class=n>ticker</span><span class=si>}</span><span class=s2>&#34;</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>legend</span><span class=p>()</span>
</span></span><span class=line><span class=cl><span class=n>plt</span><span class=o>.</span><span class=n>show</span><span class=p>()</span>
</span></span></code></pre></div><p>This code will generate a plot showing how the Kalman Filter smooths out the noisy stock price data and estimates the underlying trend.</p><h2 id=conclusion>Conclusion</h2><p>The Kalman Filter is a versatile tool in quantitative finance that allows practitioners to model dynamic systems with uncertainty and noise. By applying the filter to various financial problems—such as estimating asset prices, managing risk, and optimizing portfolios—it is possible to make more accurate predictions and improve decision-making. The implementation of the Kalman Filter in Python, as demonstrated, can be easily adapted to a range of financial models, offering both simplicity and power. Whether you&rsquo;re a quantitative analyst or a trader, understanding and applying the Kalman Filter is a valuable skill in modern finance.</p></div><footer class=post-footer><nav class=paginav>Category:<a href=https://finance.googlexy.com/categories/quantitative-finance-models/>Quantitative Finance Models</a></nav><nav class=paginav><a class=prev href=https://finance.googlexy.com/how-to-implement-the-heston-model-in-quantitative-finance/><span class=title>« Prev</span><br><span>How to Implement the Heston Model in Quantitative Finance</span>
</a><a class=next href=https://finance.googlexy.com/how-to-incorporate-macroeconomic-indicators-into-quantitative-finance-models/><span class=title>Next »</span><br><span>How to Incorporate Macroeconomic Indicators into Quantitative Finance Models</span></a></nav><nav class=paginav><ul style=list-style-type:none><li><small>See Also</small></li><li><ul style=list-style-type:none><li><small><a href=/building-credit-migration-models-in-quantitative-finance/>Building Credit Migration Models in Quantitative Finance</a></small></li><li><small><a href=/quantitative-finance-models-for-predicting-stock-prices/>Quantitative Finance Models for Predicting Stock Prices</a></small></li><li><small><a href=/stochastic-volatility-models-a-comprehensive-guide/>Stochastic Volatility Models: A Comprehensive Guide</a></small></li><li><small><a href=/quantitative-finance-models-for-value-at-risk-estimation/>Quantitative Finance Models for Value at Risk Estimation</a></small></li><li><small><a href=/the-impact-of-news-and-sentiment-analysis-in-quantitative-finance-models/>The Impact of News and Sentiment Analysis in Quantitative Finance Models</a></small></li></ul></li></ul></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://finance.googlexy.com/>All the money talk you need!</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>