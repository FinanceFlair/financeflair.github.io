<!doctype html><html lang=en dir=auto><head><title>Implementing the Cox-Ingersoll-Ross Model in R</title>
<link rel=canonical href=https://finance.googlexy.com/implementing-the-cox-ingersoll-ross-model-in-r/><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><meta name=description content><meta name=author content><link crossorigin=anonymous href=/assets/css/stylesheet.b609c58d5c11bb90b1a54e04005d74ad1ddf22165eb79f5533967e57df9c3b50.css integrity="sha256-tgnFjVwRu5CxpU4EAF10rR3fIhZet59VM5Z+V9+cO1A=" rel="preload stylesheet" as=style><link rel=icon href=https://finance.googlexy.com/logo.svg><link rel=icon type=image/png sizes=16x16 href=https://finance.googlexy.com/logo.svg><link rel=icon type=image/png sizes=32x32 href=https://finance.googlexy.com/logo.svg><link rel=apple-touch-icon href=https://finance.googlexy.com/logo.svg><link rel=mask-icon href=https://finance.googlexy.com/logo.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://finance.googlexy.com/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:title" content="All the money talk you need!"><meta property="og:description" content><meta property="og:type" content="website"><meta property="og:url" content="https://finance.googlexy.com/"><meta name=twitter:card content="summary"><meta name=twitter:title content="All the money talk you need!"><meta name=twitter:description content><script type=application/ld+json>{"@context":"https://schema.org","@type":"Organization","name":"All the money talk you need!","url":"https://finance.googlexy.com/","description":"","thumbnailUrl":"https://finance.googlexy.com/logo.svg","sameAs":[]}</script><script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6194699946397512" crossorigin=anonymous></script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://finance.googlexy.com/ accesskey=h title="Home (Alt + H)"><img src=https://finance.googlexy.com/logo.svg alt aria-label=logo height=35>Home</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://finance.googlexy.com/articles/ title=Articles><span>Articles</span></a></li><li><a href=https://finance.googlexy.com/categories/ title=Categories><span>Categories</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class="post-title entry-hint-parent">Implementing the Cox-Ingersoll-Ross Model in R</h1><div class=post-description></div></header><figure class=entry-cover><img loading=eager src=https://finance.googlexy.com/images/quantitative-finance-models.jpeg alt></figure><br><div class=post-content><p>The Cox-Ingersoll-Ross (CIR) model is a fundamental tool in financial mathematics, widely used for modeling interest rates, volatility, and other mean-reverting processes. Its unique property of ensuring non-negativity makes it a popular choice for modeling variables like interest rates that cannot be negative by nature. This article explores how to implement the CIR model in R, from understanding its mathematical foundation to practical step-by-step coding and applications.</p><h2 id=what-is-the-cox-ingersoll-ross-model>What is the Cox-Ingersoll-Ross Model?</h2><p>At its core, the CIR model describes the evolution of a short-term interest rate ( r_t ) under a stochastic differential equation (SDE):</p><p>[
dr_t = \kappa (\theta - r_t) dt + \sigma \sqrt{r_t} dW_t
]</p><p>where:</p><ul><li>( \kappa ) (speed of mean reversion): Determines how quickly the rate reverts to the mean.</li><li>( \theta ) (long-term mean): The mean level that ( r_t ) gravitates toward.</li><li>( \sigma ) (volatility): Controls the magnitude of randomness.</li><li>( W_t ): A Wiener process or Brownian motion.</li></ul><p>The square root term ( \sqrt{r_t} ) in the diffusion coefficient ensures that the process stays positive or at least non-negative, making it well-suited for interest rate modeling.</p><h2 id=why-use-the-cir-model>Why Use the CIR Model?</h2><p>While models like Vasicek also model mean-reverting interest rates, the Vasicek model allows rates to go negative, which might not be realistic. The CIR model avoids this through its diffusion term. This positivity constraint is crucial not only in interest rate models but also when modeling credit risk, stochastic volatility in option pricing, and macroeconomic variables.</p><h2 id=step-1-setting-up-the-simulation-environment-in-r>Step 1: Setting up the Simulation Environment in R</h2><p>Before diving into the code, ensure R is installed on your system along with essential packages like <code>sde</code> and <code>ggplot2</code> for simulation and visualization.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=nf>install.packages</span><span class=p>(</span><span class=nf>c</span><span class=p>(</span><span class=s>&#34;sde&#34;</span><span class=p>,</span> <span class=s>&#34;ggplot2&#34;</span><span class=p>))</span>
</span></span><span class=line><span class=cl><span class=nf>library</span><span class=p>(</span><span class=n>sde</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nf>library</span><span class=p>(</span><span class=n>ggplot2</span><span class=p>)</span>
</span></span></code></pre></div><p>The <code>sde</code> package provides tools specifically for simulating stochastic differential equations, including the CIR process.</p><h2 id=step-2-defining-the-cir-sde-in-r>Step 2: Defining the CIR SDE in R</h2><p>In the <code>sde</code> package, we can use the <code>sde.sim()</code> function to simulate stochastic processes, but first, define the drift and diffusion functions aligned with the CIR model.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=c1># Drift function of CIR: kappa*(theta - r)</span>
</span></span><span class=line><span class=cl><span class=n>drift_cir</span> <span class=o>&lt;-</span> <span class=kr>function</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>t</span><span class=p>,</span> <span class=n>kappa</span><span class=p>,</span> <span class=n>theta</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>kappa</span> <span class=o>*</span> <span class=p>(</span><span class=n>theta</span> <span class=o>-</span> <span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Diffusion function of CIR: sigma * sqrt(r)</span>
</span></span><span class=line><span class=cl><span class=n>diffusion_cir</span> <span class=o>&lt;-</span> <span class=kr>function</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>t</span><span class=p>,</span> <span class=n>sigma</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>sigma</span> <span class=o>*</span> <span class=nf>sqrt</span><span class=p>(</span><span class=n>x</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h2 id=step-3-simulating-the-cir-process>Step 3: Simulating the CIR Process</h2><p>Let&rsquo;s simulate the CIR process over a fixed time horizon.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=c1># Parameters</span>
</span></span><span class=line><span class=cl><span class=n>kappa</span> <span class=o>&lt;-</span> <span class=m>0.5</span>     <span class=c1># speed of mean reversion</span>
</span></span><span class=line><span class=cl><span class=n>theta</span> <span class=o>&lt;-</span> <span class=m>0.02</span>    <span class=c1># long-term mean interest rate</span>
</span></span><span class=line><span class=cl><span class=n>sigma</span> <span class=o>&lt;-</span> <span class=m>0.1</span>     <span class=c1># volatility</span>
</span></span><span class=line><span class=cl><span class=n>r0</span> <span class=o>&lt;-</span> <span class=m>0.03</span>       <span class=c1># initial interest rate</span>
</span></span><span class=line><span class=cl><span class=bp>T</span> <span class=o>&lt;-</span> <span class=m>1</span>           <span class=c1># total time (1 year)</span>
</span></span><span class=line><span class=cl><span class=n>N</span> <span class=o>&lt;-</span> <span class=m>252</span>         <span class=c1># number of time steps (trading days)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Time grid</span>
</span></span><span class=line><span class=cl><span class=n>dt</span> <span class=o>&lt;-</span> <span class=bp>T</span> <span class=o>/</span> <span class=n>N</span>
</span></span><span class=line><span class=cl><span class=n>time</span> <span class=o>&lt;-</span> <span class=nf>seq</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=bp>T</span><span class=p>,</span> <span class=n>length.out</span> <span class=o>=</span> <span class=n>N</span><span class=m>+1</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Initialize vector to store rates</span>
</span></span><span class=line><span class=cl><span class=n>r</span> <span class=o>&lt;-</span> <span class=nf>numeric</span><span class=p>(</span><span class=n>N</span><span class=m>+1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r[1]</span> <span class=o>&lt;-</span> <span class=n>r0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Simulate using Euler-Maruyama method for discretization</span>
</span></span><span class=line><span class=cl><span class=nf>set.seed</span><span class=p>(</span><span class=m>123</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=kr>for</span> <span class=p>(</span><span class=n>i</span> <span class=kr>in</span> <span class=m>2</span><span class=o>:</span><span class=p>(</span><span class=n>N</span><span class=m>+1</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>drift</span> <span class=o>&lt;-</span> <span class=n>kappa</span> <span class=o>*</span> <span class=p>(</span><span class=n>theta</span> <span class=o>-</span> <span class=n>r[i</span><span class=m>-1</span><span class=n>]</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>diffusion</span> <span class=o>&lt;-</span> <span class=n>sigma</span> <span class=o>*</span> <span class=nf>sqrt</span><span class=p>(</span><span class=n>r[i</span><span class=m>-1</span><span class=n>]</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=n>dW</span> <span class=o>&lt;-</span> <span class=nf>rnorm</span><span class=p>(</span><span class=m>1</span><span class=p>,</span> <span class=n>mean</span> <span class=o>=</span> <span class=m>0</span><span class=p>,</span> <span class=n>sd</span> <span class=o>=</span> <span class=nf>sqrt</span><span class=p>(</span><span class=n>dt</span><span class=p>))</span>
</span></span><span class=line><span class=cl>  <span class=n>r[i]</span> <span class=o>&lt;-</span> <span class=n>r[i</span><span class=m>-1</span><span class=n>]</span> <span class=o>+</span> <span class=n>drift</span> <span class=o>*</span> <span class=n>dt</span> <span class=o>+</span> <span class=n>diffusion</span> <span class=o>*</span> <span class=n>dW</span>
</span></span><span class=line><span class=cl>  <span class=c1># Ensure non-negativity</span>
</span></span><span class=line><span class=cl>  <span class=kr>if</span><span class=p>(</span><span class=n>r[i]</span> <span class=o>&lt;</span> <span class=m>0</span><span class=p>)</span> <span class=n>r[i]</span> <span class=o>&lt;-</span> <span class=m>0</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Plot the simulated interest rates</span>
</span></span><span class=line><span class=cl><span class=n>df</span> <span class=o>&lt;-</span> <span class=nf>data.frame</span><span class=p>(</span><span class=n>time</span> <span class=o>=</span> <span class=n>time</span><span class=p>,</span> <span class=n>rate</span> <span class=o>=</span> <span class=n>r</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>ggplot</span><span class=p>(</span><span class=n>df</span><span class=p>,</span> <span class=nf>aes</span><span class=p>(</span><span class=n>x</span> <span class=o>=</span> <span class=n>time</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>rate</span><span class=p>))</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>  <span class=nf>geom_line</span><span class=p>(</span><span class=n>color</span> <span class=o>=</span> <span class=s>&#34;steelblue&#34;</span><span class=p>)</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>  <span class=nf>labs</span><span class=p>(</span><span class=n>title</span> <span class=o>=</span> <span class=s>&#34;Simulated CIR Interest Rate Process&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>       <span class=n>x</span> <span class=o>=</span> <span class=s>&#34;Time (Years)&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>       <span class=n>y</span> <span class=o>=</span> <span class=s>&#34;Interest Rate&#34;</span><span class=p>)</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>  <span class=nf>theme_minimal</span><span class=p>()</span>
</span></span></code></pre></div><h3 id=explanation>Explanation:</h3><ul><li>The Euler-Maruyama method approximates the SDE, discretely simulating increments.</li><li>The check <code>if(r[i] &lt; 0) r[i] &lt;- 0</code> ensures the rates don&rsquo;t dip below zero due to discretization errors.</li><li>This approach provides an intuitive and easy-to-understand way to simulate the CIR process but may introduce bias for large time steps.</li></ul><h2 id=step-4-exact-simulation-for-cir>Step 4: Exact Simulation for CIR</h2><p>Euler discretization might not always maintain the accurate distribution of the CIR process, especially for larger time steps. Fortunately, the CIR process has a known transition density, which follows a scaled non-central chi-square distribution. Leveraging this property allows for exact simulation.</p><p>The next value ( r_{t+\Delta t} ) given ( r_t ) is distributed as:</p><p>[
r_{t+\Delta t} = \frac{c}{4\kappa} \chi^2_{d}(\lambda)
]</p><p>Where:</p><ul><li>( c = \frac{4 \kappa \theta}{\sigma^2} )</li><li>( d = \frac{4 \kappa \theta}{\sigma^2} ) degrees of freedom</li><li>( \lambda = \frac{4 \kappa e^{-\kappa \Delta t}}{\sigma^2 (1 - e^{-\kappa \Delta t})} r_t )</li></ul><p>Implementing this exact method in R requires drawing from the non-central chi-square distribution.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=c1># Function to simulate the next step exactly</span>
</span></span><span class=line><span class=cl><span class=n>cir_exact_step</span> <span class=o>&lt;-</span> <span class=kr>function</span><span class=p>(</span><span class=n>r_t</span><span class=p>,</span> <span class=n>dt</span><span class=p>,</span> <span class=n>kappa</span><span class=p>,</span> <span class=n>theta</span><span class=p>,</span> <span class=n>sigma</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>c</span> <span class=o>&lt;-</span> <span class=p>(</span><span class=m>2</span> <span class=o>*</span> <span class=n>kappa</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>sigma^2</span> <span class=o>*</span> <span class=p>(</span><span class=m>1</span> <span class=o>-</span> <span class=nf>exp</span><span class=p>(</span><span class=o>-</span><span class=n>kappa</span> <span class=o>*</span> <span class=n>dt</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=n>d</span> <span class=o>&lt;-</span> <span class=p>(</span><span class=m>4</span> <span class=o>*</span> <span class=n>kappa</span> <span class=o>*</span> <span class=n>theta</span><span class=p>)</span> <span class=o>/</span> <span class=n>sigma^2</span>
</span></span><span class=line><span class=cl>  <span class=n>lambda</span> <span class=o>&lt;-</span> <span class=n>c</span> <span class=o>*</span> <span class=n>r_t</span> <span class=o>*</span> <span class=nf>exp</span><span class=p>(</span><span class=o>-</span><span class=n>kappa</span> <span class=o>*</span> <span class=n>dt</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=c1># Draw from non-central chi-square distribution</span>
</span></span><span class=line><span class=cl>  <span class=n>r_next</span> <span class=o>&lt;-</span> <span class=nf>rchisq</span><span class=p>(</span><span class=m>1</span><span class=p>,</span> <span class=n>df</span> <span class=o>=</span> <span class=n>d</span><span class=p>,</span> <span class=n>ncp</span> <span class=o>=</span> <span class=n>lambda</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=m>2</span> <span class=o>*</span> <span class=n>c</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=kr>return</span><span class=p>(</span><span class=n>r_next</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Simulate the CIR with exact method</span>
</span></span><span class=line><span class=cl><span class=n>N</span> <span class=o>&lt;-</span> <span class=m>252</span>
</span></span><span class=line><span class=cl><span class=n>time</span> <span class=o>&lt;-</span> <span class=nf>seq</span><span class=p>(</span><span class=m>0</span><span class=p>,</span> <span class=bp>T</span><span class=p>,</span> <span class=n>length.out</span> <span class=o>=</span> <span class=n>N</span><span class=m>+1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r_exact</span> <span class=o>&lt;-</span> <span class=nf>numeric</span><span class=p>(</span><span class=n>N</span><span class=m>+1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>r_exact[1]</span> <span class=o>&lt;-</span> <span class=n>r0</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>set.seed</span><span class=p>(</span><span class=m>123</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=kr>for</span> <span class=p>(</span><span class=n>i</span> <span class=kr>in</span> <span class=m>2</span><span class=o>:</span><span class=p>(</span><span class=n>N</span><span class=m>+1</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>r_exact[i]</span> <span class=o>&lt;-</span> <span class=nf>cir_exact_step</span><span class=p>(</span><span class=n>r_exact[i</span><span class=m>-1</span><span class=n>]</span><span class=p>,</span> <span class=n>dt</span><span class=p>,</span> <span class=n>kappa</span><span class=p>,</span> <span class=n>theta</span><span class=p>,</span> <span class=n>sigma</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Plot comparison Euler vs Exact</span>
</span></span><span class=line><span class=cl><span class=n>df2</span> <span class=o>&lt;-</span> <span class=nf>data.frame</span><span class=p>(</span>
</span></span><span class=line><span class=cl>  <span class=n>time</span> <span class=o>=</span> <span class=nf>rep</span><span class=p>(</span><span class=n>time</span><span class=p>,</span> <span class=m>2</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=n>rate</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=n>r</span><span class=p>,</span> <span class=n>r_exact</span><span class=p>),</span>
</span></span><span class=line><span class=cl>  <span class=n>method</span> <span class=o>=</span> <span class=nf>rep</span><span class=p>(</span><span class=nf>c</span><span class=p>(</span><span class=s>&#34;Euler-Maruyama&#34;</span><span class=p>,</span> <span class=s>&#34;Exact Simulation&#34;</span><span class=p>),</span> <span class=n>each</span> <span class=o>=</span> <span class=n>N</span><span class=m>+1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=nf>ggplot</span><span class=p>(</span><span class=n>df2</span><span class=p>,</span> <span class=nf>aes</span><span class=p>(</span><span class=n>x</span> <span class=o>=</span> <span class=n>time</span><span class=p>,</span> <span class=n>y</span> <span class=o>=</span> <span class=n>rate</span><span class=p>,</span> <span class=n>color</span> <span class=o>=</span> <span class=n>method</span><span class=p>))</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>  <span class=nf>geom_line</span><span class=p>()</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>  <span class=nf>labs</span><span class=p>(</span><span class=n>title</span> <span class=o>=</span> <span class=s>&#34;CIR Process: Euler vs Exact Simulation&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>       <span class=n>x</span> <span class=o>=</span> <span class=s>&#34;Time (Years)&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>       <span class=n>y</span> <span class=o>=</span> <span class=s>&#34;Interest Rate&#34;</span><span class=p>)</span> <span class=o>+</span>
</span></span><span class=line><span class=cl>  <span class=nf>theme_minimal</span><span class=p>()</span>
</span></span></code></pre></div><h3 id=observations>Observations:</h3><ul><li>Exact simulation preserves the distribution and non-negativity inherently.</li><li>Euler-Maruyama is simpler but needs finer discretization steps to approximate well.</li><li>Exact methods can be more computation-intensive but are preferred when accuracy is crucial.</li></ul><h2 id=step-5-estimating-parameters-from-data>Step 5: Estimating Parameters from Data</h2><p>Suppose you have observed interest rate data and want to fit the CIR parameters (( \kappa, \theta, \sigma )). There are several approaches, including:</p><ul><li>Maximum Likelihood Estimation (MLE)</li><li>Generalized Method of Moments (GMM)</li><li>Least Squares Approximation based on discretized data</li></ul><h3 id=using-maximum-likelihood-estimation>Using Maximum Likelihood Estimation</h3><p>Because the transition density is known, MLE is an effective method.</p><p>We use the conditional density for ( r_{t+dt} ) given ( r_t ), which is non-central chi-square. The negative log-likelihood can be constructed and minimized.</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=c1># Log-likelihood function for CIR</span>
</span></span><span class=line><span class=cl><span class=n>log_likelihood_cir</span> <span class=o>&lt;-</span> <span class=kr>function</span><span class=p>(</span><span class=n>params</span><span class=p>,</span> <span class=n>r</span><span class=p>,</span> <span class=n>dt</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>kappa</span> <span class=o>&lt;-</span> <span class=n>params[1]</span>
</span></span><span class=line><span class=cl>  <span class=n>theta</span> <span class=o>&lt;-</span> <span class=n>params[2]</span>
</span></span><span class=line><span class=cl>  <span class=n>sigma</span> <span class=o>&lt;-</span> <span class=n>params[3]</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=kr>if</span> <span class=p>(</span><span class=n>sigma</span> <span class=o>&lt;=</span> <span class=m>0</span> <span class=o>||</span> <span class=n>kappa</span> <span class=o>&lt;=</span> <span class=m>0</span> <span class=o>||</span> <span class=n>theta</span> <span class=o>&lt;=</span> <span class=m>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kr>return</span><span class=p>(</span><span class=kc>Inf</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=n>c</span> <span class=o>&lt;-</span> <span class=p>(</span><span class=m>2</span> <span class=o>*</span> <span class=n>kappa</span><span class=p>)</span> <span class=o>/</span> <span class=p>(</span><span class=n>sigma^2</span> <span class=o>*</span> <span class=p>(</span><span class=m>1</span> <span class=o>-</span> <span class=nf>exp</span><span class=p>(</span><span class=o>-</span><span class=n>kappa</span> <span class=o>*</span> <span class=n>dt</span><span class=p>)))</span>
</span></span><span class=line><span class=cl>  <span class=n>d</span> <span class=o>&lt;-</span> <span class=p>(</span><span class=m>4</span> <span class=o>*</span> <span class=n>kappa</span> <span class=o>*</span> <span class=n>theta</span><span class=p>)</span> <span class=o>/</span> <span class=n>sigma^2</span>
</span></span><span class=line><span class=cl>  <span class=n>loglik</span> <span class=o>&lt;-</span> <span class=m>0</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=kr>for</span><span class=p>(</span><span class=n>i</span> <span class=kr>in</span> <span class=m>1</span><span class=o>:</span><span class=p>(</span><span class=nf>length</span><span class=p>(</span><span class=n>r</span><span class=p>)</span><span class=m>-1</span><span class=p>))</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=n>lambda</span> <span class=o>&lt;-</span> <span class=n>c</span> <span class=o>*</span> <span class=n>r[i]</span> <span class=o>*</span> <span class=nf>exp</span><span class=p>(</span><span class=o>-</span><span class=n>kappa</span> <span class=o>*</span> <span class=n>dt</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>x</span> <span class=o>&lt;-</span> <span class=m>2</span> <span class=o>*</span> <span class=n>c</span> <span class=o>*</span> <span class=n>r[i</span><span class=m>+1</span><span class=n>]</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=c1># Density of non-central chi-square</span>
</span></span><span class=line><span class=cl>    <span class=n>dens</span> <span class=o>&lt;-</span> <span class=nf>dchisq</span><span class=p>(</span><span class=n>x</span><span class=p>,</span> <span class=n>df</span> <span class=o>=</span> <span class=n>d</span><span class=p>,</span> <span class=n>ncp</span> <span class=o>=</span> <span class=n>lambda</span><span class=p>)</span>
</span></span><span class=line><span class=cl>    <span class=n>dens</span> <span class=o>&lt;-</span> <span class=nf>max</span><span class=p>(</span><span class=n>dens</span><span class=p>,</span> <span class=m>1e-10</span><span class=p>)</span> <span class=c1># Avoid log(0)</span>
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    <span class=n>loglik</span> <span class=o>&lt;-</span> <span class=n>loglik</span> <span class=o>+</span> <span class=nf>log</span><span class=p>(</span><span class=n>dens</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=kr>return</span><span class=p>(</span><span class=o>-</span><span class=n>loglik</span><span class=p>)</span> <span class=c1># negative log-likelihood</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Example: Fit parameters to simulated data (using exact simulated data)</span>
</span></span><span class=line><span class=cl><span class=nf>library</span><span class=p>(</span><span class=n>stats</span><span class=p>)</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>init_params</span> <span class=o>&lt;-</span> <span class=nf>c</span><span class=p>(</span><span class=n>kappa</span> <span class=o>=</span> <span class=m>0.5</span><span class=p>,</span> <span class=n>theta</span> <span class=o>=</span> <span class=m>0.02</span><span class=p>,</span> <span class=n>sigma</span> <span class=o>=</span> <span class=m>0.1</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=n>fit</span> <span class=o>&lt;-</span> <span class=nf>optim</span><span class=p>(</span><span class=n>init_params</span><span class=p>,</span> <span class=n>log_likelihood_cir</span><span class=p>,</span>
</span></span><span class=line><span class=cl>             <span class=n>r</span> <span class=o>=</span> <span class=n>r_exact</span><span class=p>,</span>
</span></span><span class=line><span class=cl>             <span class=n>dt</span> <span class=o>=</span> <span class=n>dt</span><span class=p>,</span>
</span></span><span class=line><span class=cl>             <span class=n>method</span> <span class=o>=</span> <span class=s>&#34;L-BFGS-B&#34;</span><span class=p>,</span>
</span></span><span class=line><span class=cl>             <span class=n>lower</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=m>0.0001</span><span class=p>,</span> <span class=m>0.0001</span><span class=p>,</span> <span class=m>0.0001</span><span class=p>),</span>
</span></span><span class=line><span class=cl>             <span class=n>upper</span> <span class=o>=</span> <span class=nf>c</span><span class=p>(</span><span class=m>5</span><span class=p>,</span> <span class=m>1</span><span class=p>,</span> <span class=m>1</span><span class=p>))</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=n>fit</span><span class=o>$</span><span class=n>par</span>
</span></span></code></pre></div><h3 id=notes>Notes:</h3><ul><li>The <code>optim</code> function tries to minimize the negative log-likelihood.</li><li>Bounds are added to prevent non-physical parameter values.</li><li>Initial values should be close to expected parameters to ensure convergence.</li></ul><h2 id=step-6-practical-applications-of-the-cir-model-in-finance>Step 6: Practical Applications of the CIR Model in Finance</h2><p>Once implemented, the CIR model can be used for:</p><ul><li><strong>Interest rate simulation:</strong> Model future interest rates for bond pricing or risk management.</li><li><strong>Bond pricing:</strong> Calculate zero-coupon bond prices under the CIR short rate model using closed-form solutions.</li><li><strong>Credit risk modeling:</strong> Model default intensities where rates should remain positive.</li><li><strong>Stochastic volatility:</strong> In models like the Heston model, variance follows a CIR process.</li></ul><h3 id=zero-coupon-bond-pricing-with-cir>Zero-Coupon Bond Pricing with CIR</h3><p>The prices ( P(t,T) ) of zero-coupon bonds when interest rates evolve according to the CIR model have a closed-form solution:</p><p>[
P(t, T) = A(t, T) \cdot e^{-B(t,T) r_t}
]</p><p>Where:</p><p>[
B(t, T) = \frac{2(e^{\gamma (T-t)} - 1)}{( \gamma + \kappa)(e^{\gamma (T-t)} - 1) + 2\gamma}
]</p><p>[
A(t, T) = \left( \frac{2 \gamma e^{(\kappa + \gamma) (T-t)/2}}{( \gamma + \kappa)(e^{\gamma (T-t)} - 1) + 2 \gamma} \right)^{\frac{2 \kappa \theta}{\sigma^2}}
]</p><p>and</p><p>[
\gamma = \sqrt{\kappa^2 + 2 \sigma^2}
]</p><p>Here’s how to implement this bond pricing in R:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-r data-lang=r><span class=line><span class=cl><span class=n>cir_bond_price</span> <span class=o>&lt;-</span> <span class=kr>function</span><span class=p>(</span><span class=n>r_t</span><span class=p>,</span> <span class=n>t</span><span class=p>,</span> <span class=bp>T</span><span class=p>,</span> <span class=n>kappa</span><span class=p>,</span> <span class=n>theta</span><span class=p>,</span> <span class=n>sigma</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=n>tau</span> <span class=o>&lt;-</span> <span class=bp>T</span> <span class=o>-</span> <span class=n>t</span>
</span></span><span class=line><span class=cl>  <span class=n>gamma</span> <span class=o>&lt;-</span> <span class=nf>sqrt</span><span class=p>(</span><span class=n>kappa^2</span> <span class=o>+</span> <span class=m>2</span> <span class=o>*</span> <span class=n>sigma^2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=n>B</span> <span class=o>&lt;-</span> <span class=p>(</span><span class=m>2</span> <span class=o>*</span> <span class=p>(</span><span class=nf>exp</span><span class=p>(</span><span class=n>gamma</span> <span class=o>*</span> <span class=n>tau</span><span class=p>)</span> <span class=o>-</span> <span class=m>1</span><span class=p>))</span> <span class=o>/</span> <span class=p>((</span><span class=n>gamma</span> <span class=o>+</span> <span class=n>kappa</span><span class=p>)</span> <span class=o>*</span> <span class=p>(</span><span class=nf>exp</span><span class=p>(</span><span class=n>gamma</span> <span class=o>*</span> <span class=n>tau</span><span class=p>)</span> <span class=o>-</span> <span class=m>1</span><span class=p>)</span> <span class=o>+</span> <span class=m>2</span> <span class=o>*</span> <span class=n>gamma</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=n>A</span> <span class=o>&lt;-</span> <span class=p>((</span><span class=m>2</span> <span class=o>*</span> <span class=n>gamma</span> <span class=o>*</span> <span class=nf>exp</span><span class=p>((</span><span class=n>kappa</span> <span class=o>+</span> <span class=n>gamma</span><span class=p>)</span> <span class=o>*</span> <span class=n>tau</span> <span class=o>/</span> <span class=m>2</span><span class=p>))</span> <span class=o>/</span> <span class=p>((</span><span class=n>gamma</span> <span class=o>+</span> <span class=n>kappa</span><span class=p>)</span> <span class=o>*</span> <span class=p>(</span><span class=nf>exp</span><span class=p>(</span><span class=n>gamma</span> <span class=o>*</span> <span class=n>tau</span><span class=p>)</span> <span class=o>-</span> <span class=m>1</span><span class=p>)</span> <span class=o>+</span> <span class=m>2</span> <span class=o>*</span> <span class=n>gamma</span><span class=p>))</span><span class=nf>^</span><span class=p>(</span><span class=m>2</span> <span class=o>*</span> <span class=n>kappa</span> <span class=o>*</span> <span class=n>theta</span> <span class=o>/</span> <span class=n>sigma^2</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=n>price</span> <span class=o>&lt;-</span> <span class=n>A</span> <span class=o>*</span> <span class=nf>exp</span><span class=p>(</span><span class=o>-</span><span class=n>B</span> <span class=o>*</span> <span class=n>r_t</span><span class=p>)</span>
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  <span class=kr>return</span><span class=p>(</span><span class=n>price</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=c1># Example: Calculate price of a zero-coupon bond due in 1 year</span>
</span></span><span class=line><span class=cl><span class=n>r_t</span> <span class=o>&lt;-</span> <span class=m>0.03</span>
</span></span><span class=line><span class=cl><span class=n>t</span> <span class=o>&lt;-</span> <span class=m>0</span>
</span></span><span class=line><span class=cl><span class=bp>T</span> <span class=o>&lt;-</span> <span class=m>1</span>
</span></span><span class=line><span class=cl><span class=n>price</span> <span class=o>&lt;-</span> <span class=nf>cir_bond_price</span><span class=p>(</span><span class=n>r_t</span><span class=p>,</span> <span class=n>t</span><span class=p>,</span> <span class=bp>T</span><span class=p>,</span> <span class=n>kappa</span><span class=p>,</span> <span class=n>theta</span><span class=p>,</span> <span class=n>sigma</span><span class=p>)</span>
</span></span><span class=line><span class=cl><span class=nf>print</span><span class=p>(</span><span class=nf>paste</span><span class=p>(</span><span class=s>&#34;Bond Price:&#34;</span><span class=p>,</span> <span class=nf>round</span><span class=p>(</span><span class=n>price</span><span class=p>,</span> <span class=m>4</span><span class=p>)))</span>
</span></span></code></pre></div><p>The output gives the fair price of a zero-coupon bond under the CIR interest rate framework.</p><h2 id=step-7-extending-the-cir-model--jump-diffusion-and-multi-factor-models>Step 7: Extending the CIR Model — Jump-Diffusion and Multi-Factor Models</h2><p>The classical CIR model, while powerful, sometimes struggles to capture market realities, such as sudden jumps in rates or more complex dynamics.</p><ul><li><strong>Jump-diffusion extensions:</strong> Add Poisson-driven jump processes to better capture abrupt market changes.</li><li><strong>Multi-factor CIR models:</strong> Combine several CIR processes to capture different sources of risk and term structure dynamics.</li></ul><p>Implementing these extensions involves integrating additional terms into the SDE and adapting simulation and estimation techniques accordingly. They provide more flexibility but increase complexity significantly.</p><h2 id=conclusion>Conclusion</h2><p>Implementing the Cox-Ingersoll-Ross model in R combines mathematical insight with practical programming skills. This guide walked through the process of simulating the CIR process with both Euler and exact simulation methods, estimating parameters from data, and applying the model to bond pricing.</p><p>Whether used for academic exploration or practical financial modeling, the CIR model remains a vital part of the quantitative finance toolkit. Mastering this model in R opens doors to sophisticated interest rate analysis, risk management, and financial product valuation.</p><hr><p>If you&rsquo;re interested in further refining your CIR implementation, consider:</p><ul><li>Incorporating filtering techniques for online parameter estimation.</li><li>Comparing CIR model fitting against other interest rate models.</li><li>Extending the model for use in derivative pricing and portfolio optimization.</li></ul><p>Happy modeling!</p></div><footer class=post-footer><nav class=paginav>Category:<a href=https://finance.googlexy.com/categories/quantitative-finance-models/>Quantitative Finance Models</a></nav><nav class=paginav><a class=prev href=https://finance.googlexy.com/implementing-stochastic-models-in-quantitative-finance/><span class=title>« Prev</span><br><span>Implementing Stochastic Models in Quantitative Finance</span>
</a><a class=next href=https://finance.googlexy.com/implementing-value-at-risk-models-in-quantitative-finance/><span class=title>Next »</span><br><span>Implementing Value-at-Risk Models in Quantitative Finance</span></a></nav><nav class=paginav><ul style=list-style-type:none><li><small>See Also</small></li><li><ul style=list-style-type:none><li><small><a href=/how-to-use-data-visualization-in-quantitative-finance/>How to Use Data Visualization in Quantitative Finance</a></small></li><li><small><a href=/optimizing-operational-risk-models-with-machine-learning/>Optimizing Operational Risk Models with Machine Learning</a></small></li><li><small><a href=/the-role-of-simulation-in-quantitative-finance-models/>The Role of Simulation in Quantitative Finance Models</a></small></li><li><small><a href=/exploring-autoregressive-integrated-moving-average-arima-models-in-quantitative-finance/>Exploring Autoregressive Integrated Moving Average (ARIMA) Models in Quantitative Finance</a></small></li><li><small><a href=/exploring-garch-models-in-quantitative-finance/>Exploring GARCH Models in Quantitative Finance</a></small></li></ul></li></ul></nav></footer></article></main><footer class=footer><span>&copy; 2025 <a href=https://finance.googlexy.com/>All the money talk you need!</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg>
</a><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script></body></html>